#!/bin/bash

# Fuzzy-find a git commit.
# You can use `git shalector master` to select commits from master,
# otherwise it uses the current branch.

set -e

branch=${1:-$(git rev-parse HEAD)}

target_commit=$(
  git log -75 --color=always "$branch" | \
  fzf --ansi --no-sort --reverse --tiebreak=index | \
  awk '{print $1}'
)

printf "$target_commit" | pbcopy

printf "Commit hash copied ($target_commit)\n" >&2
printf "$target_commit\n"
